# astrbot_plugin_furry_maopao

一个智能的AstrBot插件，用于在QQ群中自动打卡和分时段随机发言，每个时段每个群只发言一次。

## 功能特点 v1.0.0

### 🎯 核心功能
- **分时段发言**：早晨、中午、晚上三个时段独立配置
- **单次发言限制**：每个群在每个时段只发言一次
- **时段专属内容**：每个时段有独立的LLM提示词和预设消息
- **简洁自然发言**：无表情干扰，内容更加自然
- **智能时间检测**：准确识别当前处于哪个时段
- **每日自动重置**：每天0点自动重置发言记录

### ⚙️ 分时段配置
- **早晨时段**：独立的消息和提示词配置
- **中午时段**：独立的午间内容配置
- **晚上时段**：独立的晚间内容配置
- **灵活启用**：每个时段可单独启用或禁用

### 🔧 高级功能
- **群间冷却**：不同群发言之间有冷却时间
- **自动重置**：每日自动清理发言记录
- **详细状态**：实时查看各时段发言情况
- **完整日志**：记录所有发言和打卡活动

## 仓库地址
- GitHub: https://github.com/furry520-source/astrbot_plugin_furry_maopao

## 主要改进 v1.2.1

1. **移除QQ表情**：发言更加简洁自然，无表情干扰
2. **分时段内容管理**：每个时段有独立的提示词和消息配置
3. **单次发言限制**：每个群在每个时段只发言一次
4. **每日自动重置**：每天0点自动重置发言记录
5. **详细状态显示**：显示各时段已发言群数

## 配置说明

### 时间段配置（核心）
- `time_slots`: 三个时间段配置，留空则不启用
  - `morning`: 早晨时段，如 `06:40-08:15`
  - `noon`: 中午时段，如 `11:30-13:20`
  - `evening`: 晚上时段，如 `19:20-22:15`

### 分时段内容配置
- `morning_prompts` / `noon_prompts` / `evening_prompts`: 各时段LLM提示词
- `morning_messages` / `noon_messages` / `evening_messages`: 各时段预设消息

### 发言控制
- `group_cooldown`: 不同群发言冷却时间（默认5分钟）
- `use_llm`: 是否使用LLM生成内容

### 打卡功能
- `enable_group_checkin`: 启用打卡
- `checkin_time`: 打卡时间，留空则不打卡
- `checkin_messages`: 打卡消息列表（无表情）

## 管理员命令

### 状态管理
- `/发言状态` - 查看详细状态和各时段情况
- `/立即发言` - 立即在当前群发言（遵守时段限制）
- `/测试时段发言 <时段>` - 测试生成时段内容

### 配置管理
- `/查看时段消息 [时段]` - 查看时段消息配置
- `/添加时段消息 <时段> <消息>` - 添加时段消息/提示词
- `/重置发言记录` - 手动重置发言记录
- `/重置打卡` - 重置打卡天数

### 时段说明
- `morning`: 早晨时段
- `noon`: 中午时段  
- `evening`: 晚上时段

## 工作原理

### 发言流程
1. **时间检测**：每分钟检查当前时间属于哪个时段
2. **时段限制**：检查当前时段是否已在该群发言过
3. **群组筛选**：找出尚未在当前时段发言的群组
4. **内容生成**：使用对应时段的配置生成内容（无表情）
5. **发送消息**：随机选择一个群发送消息
6. **标记记录**：记录该群已在当前时段发言

### 每日重置
- 每天0点自动重置所有时段的发言记录
- 每个群在每个时段重新获得发言机会
- 保证每天都有新鲜内容

## 使用示例

### 1. 分时段内容配置
```

早晨时段 (06:40-08:15):

· 提示词：分享早安问候、鼓励话语
· 消息：大家早上好呀~新的一天开始了！

中午时段 (11:30-13:20):

· 提示词：提醒午餐、午休建议
· 消息：午饭时间到，大家吃饭了吗？

晚上时段 (19:20-22:15):

· 提示词：晚间问候、放松建议
· 消息：晚上好，今天过得怎么样？

```

### 2. 灵活启用
```

仅启用晚上时段：

· morning: (留空)
· noon: (留空)
· evening: 19:20-22:15

```

### 3. 混合模式
```

早晨用LLM，中午用预设：

· use_llm: true
· morning_prompts: [分享早安问候...]
· noon_messages: [午饭时间到...]

```

## 注意事项

1. **无表情干扰**：所有发言均为纯文本，更加自然
2. **时段独立性**：每个时段的发言记录独立管理
3. **每日重置**：发言记录每天自动清零
4. **时段检测**：准确识别当前处于哪个时段
5. **群间冷却**：避免同时在多个群发言
6. **内容定制**：可单独配置每个时段的内容风格
7. **禁用时段**：留空的时间段不会启用发言

## 消息风格建议

### 早晨时段（06:40-08:15）
- 早安问候、鼓励话语
- 新的一天开始的感受
- 早晨的小建议或提醒

### 中午时段（11:30-13:20）
- 午餐提醒、午休建议
- 轻松愉快的午间话题
- 下午工作的鼓励

### 晚上时段（19:20-22:15）
- 晚间问候、放松建议
- 今天的生活分享
- 温馨的晚间祝福

## 更新日志

### v1.0.0
- **更新仓库地址**：改为 https://github.com/furry520-source/astrbot_plugin_furry_maopao
- **移除QQ表情**：发言更加简洁自然
- **优化默认消息**：更新为更自然的文本内容
- **清理配置文件**：移除表情相关配置项
- **简化代码结构**：移除表情处理逻辑
- **分时段内容管理**：每个时段独立的消息和提示词
- **单次发言限制**：每个群在每个时段只发言一次
- **每日自动重置**：每天0点自动清理发言记录
- **详细状态显示**：显示各时段已发言群数
- **新增管理命令**：添加时段消息、查看配置等
- **改进时间检测**：更准确的时段识别